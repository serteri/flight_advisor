
// ... (EXISTING MODELS REMAIN THE SAME)

// ----------------------------
// ğŸ›¡ï¸ TRAVEL GUARDIAN (SAAS ENGINE)
// ----------------------------
model MonitoredTrip {
  id              String   @id @default(cuid())
  userId          String
  
  // UÃ§uÅŸ Bilgileri (PNR ile Amadeus'tan Ã§ekilir)
  pnr             String   // Rezervasyon Kodu (Ã–rn: QLWZE)
  airlineCode     String   // TK
  flightNumber    String   // 1984
  departureDate   DateTime // KalkÄ±ÅŸ zamanÄ±
  arrivalDate     DateTime // VarÄ±ÅŸ zamanÄ±
  origin          String   // BNE
  destination     String   // IST

  // ğŸ’° Finansal Veriler (Arbitraj HesabÄ± Ä°Ã§in)
  originalPrice   Float    // KullanÄ±cÄ±nÄ±n Ã¶dediÄŸi: 1500.00
  currency        String   @default("AUD")
  ticketClass     String   // ECONOMY (Y), BUSINESS (J)
  fareBasis       String?  // Biletin kural kodu (Esneklik kontrolÃ¼ iÃ§in)
  isRefundable    Boolean  @default(false) // Ä°adeli mi?

  // ğŸ›ï¸ Aktif ModÃ¼ller (KullanÄ±cÄ± hangilerini aÃ§tÄ±?)
  watchPrice      Boolean  @default(true)  // Fiyat dÃ¼ÅŸerse haber ver (Arbitraj)
  watchDelay      Boolean  @default(true)  // RÃ¶tar tazminatÄ± kovala (Disruption)
  watchUpgrade    Boolean  @default(false) // Business ucuzlarsa haber ver
  watchSeat       Boolean  @default(false) // YanÄ±m dolarsa haber ver
  watchSchedule   Boolean  @default(true)  // Saat deÄŸiÅŸirse haber ver

  // ğŸ¤– Worker (Bot) YÃ¶netimi
  status          TripStatus @default(ACTIVE)
  lastCheckedAt   DateTime?  // En son ne zaman taradÄ±k?
  nextCheckAt     DateTime   // Bir sonraki tarama ne zaman? (Kuyruk buna bakar)
  checkFrequency  Int        @default(60) // Dakika cinsinden tarama sÄ±klÄ±ÄŸÄ±

  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  user            User            @relation(fields: [userId], references: [id], onDelete: Cascade)
  alerts          GuardianAlert[] // Yakalanan fÄ±rsatlar

  @@index([userId])
  @@index([status, nextCheckAt]) // Worker'lar bu indexi kullanÄ±p iÅŸ Ã§ekecek
}

enum TripStatus {
  ACTIVE      // Takipte
  COMPLETED   // UÃ§uÅŸ bitti
  CANCELLED   // KullanÄ±cÄ± iptal etti
  ARCHIVED    // Eski veri
}

// ----------------------------
// ğŸ”” GUARDIAN ALERTS (FIRSATLAR)
// ----------------------------
model GuardianAlert {
  id              String   @id @default(cuid())
  tripId          String
  
  type            AlertType // Ne bulduk?
  severity        AlertSeverity // Ne kadar Ã¶nemli?
  
  title           String   // Ã–rn: "ğŸ’° 600â‚¬ Tazminat HakkÄ±"
  message         String   // DetaylÄ± aÃ§Ä±klama
  
  potentialValue  String?  // Ã–rn: "600 EUR" veya "Save 300 AUD"
  actionLabel     String?  // Ã–rn: "Tazminat BaÅŸlat" veya "Upgrade Et"
  
  isRead          Boolean  @default(false)
  isActioned      Boolean  @default(false) // KullanÄ±cÄ± butona bastÄ± mÄ±?

  createdAt       DateTime @default(now())

  trip            MonitoredTrip @relation(fields: [tripId], references: [id], onDelete: Cascade)

  @@index([tripId])
}

enum AlertType {
  PRICE_DROP          // Arbitraj fÄ±rsatÄ±
  DISRUPTION_MONEY    // RÃ¶tar tazminatÄ±
  UPGRADE_OPPORTUNITY // Business ucuzladÄ±
  SEAT_ALERT          // Yan koltuk doldu / Ä°yi koltuk boÅŸaldÄ±
  SCHEDULE_CHANGE     // Saat deÄŸiÅŸikliÄŸi
  AMENITY_COMPENSATION // Wi-Fi bozuktu vs.
}

enum AlertSeverity {
  INFO      // Bilgilendirme
  WARNING   // Dikkat (Saat deÄŸiÅŸimi vs.)
  CRITICAL  // Acil (UÃ§uÅŸ iptali)
  MONEY     // PARA KAZANDIRAN (Tazminat/Arbitraj) - YeÅŸil yanar
}
